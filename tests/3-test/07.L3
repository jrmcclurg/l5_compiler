;; EECS 322 Compiler Construction
;; Test-3 Assignment (Test Cases for L3)
;; 5-3-12

;; Simple L3 program to test max array operation
(
  ;; this is the program entry point
  (let ([temp 10])
  (let ([esiv temp])               ;; store "20" in esiv
  (let ([eaxv (new-array esiv 0)])
  (let ([ediv eaxv])
  (let ([temp (aset ediv 0 5)])
  (let ([temp (aset ediv 1 20)])
  (let ([temp (aset ediv 2 17)])
  (let ([temp (aset ediv 3 19)])
  (let ([temp (aset ediv 4 42)])
  (let ([temp (aset ediv 5 80)])
  (let ([temp (aset ediv 6 2)])
  (let ([temp (aset ediv 7 3)])
  (let ([temp (aset ediv 8 23)])
  (let ([temp (aset ediv 9 4)])
  (let ([eaxv (print ediv)])
  (let ([a2 (:amin ediv 0 20000)])
  (let ([eaxv (print a2)])
       (print ediv))))))))))))))))))
  (:amin (arr pos min)
  (let ([len (alen arr)])
  (let ([c (= pos len)])
  (if c min (let ([t (aref arr pos)])
            (let ([p2 (+ pos 1)])
            (let ([newMin (:min2 t min)])
            (let ([temp (aset arr pos newMin)])
            (:amin arr p2 newMin)))))))))
   (:min2 (a b) (let ([v (< a b)]) (if v a b)))
)
